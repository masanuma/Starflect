# Level2・Level3固定例文使用絶対禁止 緊急修正 引き継ぎ資料

## 🚨 **緊急事態と修正内容**

### **発生した重大問題**
- **Level2**: `handleGenerateLevel2Fortune`内に固定例文がハードコード
- **Level3**: `handleGenerateLevel3Fortune`内に固定例文がハードコード
- **結果**: どの期間を選択しても同一の占い内容が表示される致命的バグ

### **修正前の問題コード**
```typescript
// Level2の問題コード（修正済み）
【総合運】
${selectedPeriodLabel}は安定した運勢が続きます。新しいチャンスが舞い込む可能性が高く、積極的な行動が幸運を引き寄せるでしょう。

【金銭運】  
${selectedPeriodLabel}の金運は上昇傾向にあります。計画的な支出を心がけることで、予想以上の収入が期待できそうです。

// Level3の問題コード（修正済み）
【総合運】
${periodLabel}は10天体の総合的な運勢が良好な流れにあります。期間の特性を活かした運勢の展開が期待でき、積極的な行動が成功を引き寄せるでしょう。
```

## 🚨 **絶対禁止事項（永続的ルール）**

### **Level2・Level3共通禁止事項**
1. **固定例文の使用は絶対禁止**
   - 「安定した運勢が続きます」
   - 「上昇傾向にあります」  
   - 「絶好調です」
   - 「慎重さが必要な時期です」
   - 「学びの機会に恵まれる」
   - 「10天体の総合的な運勢が良好な流れにあります」
   - 「期間の特性を活かした運勢の展開が期待でき」

2. **テンプレート表現の使用禁止**
   - 決まり文句やパターン化された表現
   - 期間名だけ変えた同一内容
   - 抽象的で汎用的な表現

3. **期間差別化の徹底**
   - 各期間（今日・明日・今週・来週・今月・来月・3か月・半年・1年）で完全に異なる内容
   - 期間の特性を活かした具体的な占い内容
   - 同じ表現の繰り返し絶対禁止

## ✅ **実施した修正内容**

### **Level2修正**
```typescript
**🚨Level2固定例文使用絶対禁止🚨**：
- 「安定した運勢が続きます」のような固定文言は絶対使用禁止
- 「上昇傾向にあります」「絶好調です」等の決まり文句も禁止
- 「学びの機会に恵まれる」等のテンプレート表現も禁止
- 期間ごとに完全に異なる独自の占い内容を生成すること

**Level2期間別差別化指示**：
- 短期即効型（今日・明日）：当日の具体的なタイミングや瞬間的な幸運に焦点
- 継続戦略型（週間）：1週間のリズムと流れ、段階的な変化
- 計画達成型（月間）：月全体の運勢サイクル、月末への変化
```

### **Level3修正**
```typescript
**🚨Level3期間別差別化（固定例文使用禁止）🚨**：

**期間別専用指示**：
- 短期集中型（今日・明日）：即効性のある運勢、具体的なタイミング重視
- 週間戦略型（今週・来週）：プロセス重視、週を通した運勢の流れ  
- 月間計画型（今月・来月）：運勢サイクル、月初から月末への変化
- 四半期変革型（3か月）：大きな変化、人生の転換期として
- 長期ビジョン型（半年・1年）：人生の大きな節目、長期的な運命の流れ

**🚨超重要：固定例文使用絶対禁止🚨**：
- 「10天体の総合的な運勢が良好な流れにあります」のような固定文言は絶対使用禁止
- 「期間の特性を活かした」のような抽象的表現も禁止
- 各期間に応じた具体的で独自の占い内容を必ず生成
- 同じ表現の繰り返しは絶対禁止
```

## 🎯 **修正効果**

### **修正前（問題あり）**
```
今日の総合運: 今日は安定した運勢が続きます。新しいチャンスが舞い込む可能性が高く...
来月の総合運: 来月は安定した運勢が続きます。新しいチャンスが舞い込む可能性が高く...
3か月の総合運: 3か月は安定した運勢が続きます。新しいチャンスが舞い込む可能性が高く...
```

### **修正後（期待される結果）**
```
今日の総合運: 今日は午後の時間帯が特に幸運で、直感的な判断が成功を呼びます...
来月の総合運: 来月は新しい習慣作りに最適な月となり、月末にかけて大きな成果が...  
3か月の総合運: この3か月で人生の大きな転換点を迎え、秋に向けて新たなステージが...
```

## 📋 **今後の開発ルール**

### **必須チェック項目**
1. **プロンプト作成時**
   - 固定例文は一切使用しない
   - 期間別の専用指示を必ず含める
   - テンプレート表現を避ける

2. **コードレビュー時**  
   - `【総合運】`等のセクションに固定文言がないか確認
   - `${期間}は...します`のようなパターンがないか確認
   - 期間差別化指示が含まれているか確認

3. **テスト時**
   - 複数の期間で占いを実行し、内容が異なることを確認
   - 同じ表現が繰り返されていないか確認
   - 期間特性が反映されているか確認

### **禁止パターン例**
```typescript
❌ 「${期間}は安定した運勢が続きます」
❌ 「${期間}の金運は上昇傾向にあります」  
❌ 「${期間}の恋愛運は絶好調です」
❌ 「${期間}は学びの機会に恵まれる」
❌ 「10天体の総合的な運勢が良好な流れ」
❌ 「期間の特性を活かした運勢の展開」

✅ 期間別専用指示システムの使用
✅ 具体的で独自性のある占い内容
✅ 期間特性を活かした差別化コンテンツ
```

## 🚨 **緊急時対応手順**

### **固定例文発見時の対応**
1. **即座に修正**: 固定例文を削除し、期間別指示に置き換え
2. **禁止事項追加**: 該当する固定文言を禁止リストに追加
3. **全レベル確認**: Level1・Level2・Level3すべてをチェック
4. **テスト実行**: 複数期間での動作確認
5. **引き継ぎ更新**: 本資料の更新と関係者への共有

### **緊急連絡事項**
- 固定例文の使用は占いアプリの品質に致命的な影響を与える
- 期間差別化はユーザー体験の根幹に関わる機能
- 発見次第、最優先で修正対応を実施すること

## 📊 **品質保証指標**

### **合格基準**
- ✅ 固定例文使用: 0件
- ✅ 期間差別化率: 100%（全期間で異なる内容）
- ✅ テンプレート表現: 0件
- ✅ 期間特性反映: 100%

### **テスト項目**
1. **全期間占い実行**: 今日〜1年まで全期間で占い実行
2. **内容比較**: 期間間での内容重複チェック
3. **表現確認**: 固定文言・テンプレート表現の不使用確認
4. **特性反映**: 期間特性に応じた内容生成確認

---

**最終更新**: 2025年1月30日
**対応者**: AI Assistant  
**重要度**: 🚨 最高（品質に直結する重要事項）
**影響範囲**: Level2・Level3占い機能全体
**関連ファイル**: `src/components/StepByStepResult.tsx` 